(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[955],{3340:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backoffice/roles",function(){return r(7684)}])},5862:function(e,t,r){"use strict";r.d(t,{c:function(){return o}});var n=r(5893),a=r(7294),s=r(1163),l=r(6795),o=function(e){var t=e.children,r=e.preventRedirect,o=(0,s.useRouter)(),c=o.push,i=o.route,u=(0,l.Eu)(),d=u.isAuth,f=u.status,m=u.rol;return a.useEffect((function(){d||r||f!==l.Q_.resolved||c("/login")}),[d,r,c,f]),a.useEffect((function(){i.includes("backoffice/roles")&&!["SUPERADMINISTRADOR"].includes(m)&&c("/backoffice")}),[m,i,d]),a.useEffect((function(){i.includes("backoffice/configuracion-interes")&&!["SUPERADMINISTRADOR"].includes(m)&&c("/backoffice")}),[m,i,d]),(0,n.jsx)(n.Fragment,{children:t})}},7684:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return M},default:function(){return B}});var n=r(4051),a=r.n(n),s=r(5893),l=r(7294),o=r(8908),c=(r(8198),r(4986));function i(e,t,r,n,a,s,l){try{var o=e[s](l),c=o.value}catch(i){return void r(i)}o.done?t(c):Promise.resolve(c).then(n,a)}var u=function(e){var t=e.IdSearched,r=e.dispatch,n=e.setLoading,l=function(){var e,s=(e=a().mark((function e(){var s,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=16;break}return n(!0),e.prev=2,e.next=5,(0,c.rK)("roles/listar-usuario-rol/".concat(t),{type:c.lO.auth});case 5:return s=e.sent,e.next=8,s.json();case 8:l=e.sent,400===s.status&&(r({messageRol:"Hubo un error, no ha iniciado sesi\xf3n en el portal por primera vez :("}),setTimeout((function(){r({messageRol:""})}),5e3),n(!1)),200===s.status&&(r({dataUser:[l],messageRol:"",statusRol:l.rolID}),n(!1)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),n(!1);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function l(e){i(s,n,a,l,o,"next",e)}function o(e){i(s,n,a,l,o,"throw",e)}l(void 0)}))});return function(){return s.apply(this,arguments)}}();return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"card-custom mb-4 w-full",children:[(0,s.jsx)("div",{className:"header-card-custom",children:(0,s.jsx)("span",{children:"Buscar"})}),(0,s.jsx)("div",{className:"body-card-custom",children:(0,s.jsx)("div",{className:"w-full my-1 items-center flex flex-col md:flex-row",children:(0,s.jsxs)("div",{className:"w-full mb-2",children:[(0,s.jsx)("label",{For:"userId",children:"Buscar por c\xe9dula"}),(0,s.jsxs)("div",{className:"flex relative items-center",children:[(0,s.jsx)("input",{type:"text",className:"w-full border rounded-full px-4 py-2 text-center",placeholder:"Buscar por c\xe9dula...",name:"userId",value:t,onChange:function(e){return r({IdSearched:e.target.value})},onKeyDown:function(e){return function(e){13===e.keyCode&&l(e)}(e)}}),(0,s.jsx)("img",{src:"".concat("/bancopobres","/Search-Icon.svg"),alt:"search",className:"absolute right-4"})]})]})})}),(0,s.jsx)("div",{className:"footer-card-custom",children:(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex flex-row justify-end mb-8 md:mb-0",children:[(0,s.jsx)("button",{type:"submit",onClick:function(){r({IdSearched:""}),n(!0),setTimeout((function(){n(!1)}),2e3)},className:"btn-texto ml-2",children:"Limpiar"}),(0,s.jsx)("button",{className:"btn-primario ml-2",type:"submit",onClick:l,children:"Buscar"})]})})})]})})};var d=function(e){var t=e.children;return(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"w-full mx-auto bg-white rounded-lg",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-4 text-left",children:"C.C"}),(0,s.jsx)("th",{className:"p-4 text-left",children:"Nombres"}),(0,s.jsx)("th",{className:"p-4 text-left",children:"Apellidos"}),(0,s.jsx)("th",{className:"p-4 text-left",children:"Email"}),(0,s.jsx)("th",{className:"p-4 text-left",children:"Rol"})]})}),t]})})},f=r(7420);function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(e){return(0,s.jsx)("tbody",{className:"last:border-b-0 text-sm",children:(0,s.jsxs)("tr",{className:"border-b font-section",children:[(0,s.jsx)("td",{className:"text-left p-4",children:e.cedula}),(0,s.jsx)("td",{className:"text-left p-4",children:e.nombres}),(0,s.jsx)("td",{className:"text-left p-4",children:e.apellidos}),(0,s.jsx)("td",{className:"text-left p-4",children:e.correo}),(0,s.jsxs)("td",{className:"text-left p-4",children:[" ",(0,s.jsx)(x,{dataRoles:e.rol.dataRoles,currentRolUser:e.rol.rolUser,dipatch:e.rol.dipatch,statusRol:e.rol.statusRol,setBoxConfirmChange:e.rol.setBoxConfirmChange,setRolValueSelected:e.rol.setRolValueSelected,cedula:e.cedula})]})]})})};function x(e){var t=e.dataRoles,r=e.statusRol,n=e.setBoxConfirmChange,a=e.setRolValueSelected,l=e.cedula;return(0,s.jsx)("select",{name:l,value:r,onChange:function(e){var t;n(!0),a((m(t={},e.target.name,e.target.value),m(t,"cedula",e.target.name),m(t,"valor",e.target.value),t))},children:t.map((function(e){return(0,s.jsxs)("option",{value:e.id,children:[" ",e.nombre," "]},e.id)}))})}var p=r(843),v=r(5862);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){j(e,t,r[t])}))}return e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s=[],l=!0,o=!1;try{for(r=r.call(e);!(l=(n=r.next()).done)&&(s.push(n.value),!t||s.length!==t);l=!0);}catch(c){o=!0,a=c}finally{try{l||null==r.return||r.return()}finally{if(o)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var N=function(e){var t=y(l.useState([]),2),r=t[0],n=t[1];l.useEffect((function(){for(var t=[],r=1;r<=e.meta.totalPages;r++)t.push(r);n(t)}),[e.meta.totalPages]);return(0,s.jsxs)("div",{className:"flex justify-between my-4 items-center font-section",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"numero-registros-text font-small",children:"Registros por p\xe1gina"}),(0,s.jsxs)("select",{name:"registro",id:"registro",value:e.meta.itemsPerPage,onChange:function(t){e.setMeta((function(e){return g({},e,{itemsPerPage:t.target.value,currentPage:1})}))},className:"",children:[(0,s.jsx)("option",{className:"custom-option",value:"1",children:" 1 "}),(0,s.jsx)("option",{className:"custom-option",value:"10",children:" 10 "}),(0,s.jsx)("option",{className:"custom-option",value:"20",children:" 20 "}),(0,s.jsx)("option",{className:"custom-option",value:"50",children:" 50 "}),(0,s.jsx)("option",{className:"custom-option",value:"100",children:" 100 "})]})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("button",{onClick:function(){e.setMeta((function(e){return g({},e,{currentPage:Math.max(e.currentPage-1,1)})}))},className:"inline-flex items-center paginador-contenedor-ant",children:[(0,s.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillrule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",cliprule:"evenodd"})}),(0,s.jsx)("span",{children:"Ant. "})]}),(0,s.jsx)("div",{className:"flex",children:r.map((function(t,r){return(0,s.jsx)("button",{onClick:function(){return t=r+1,void e.setMeta((function(e){return g({},e,{currentPage:t})}));var t},className:e.meta.currentPage===r+1?"paginador-numeros-activo  inline-flex items-center":"paginador-numeros  inline-flex items-center",children:t},r)}))}),(0,s.jsxs)("button",{onClick:function(){e.setMeta((function(e){return g({},e,{currentPage:Math.min(e.currentPage+1,e.totalPages)})}))},className:"inline-flex items-center paginador-contenedor-sig",disabled:e.meta.currentPage>=e.meta.totalPages,children:[e.meta.currentPage>=e.meta.totalPages?"Sig.":" Siguiente",(0,s.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,s.jsx)("path",{fillrule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",cliprule:"evenodd"})})]})]})]})},w=r(1163),P=r(1319);function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e,t,r,n,a,s,l){try{var o=e[s](l),c=o.value}catch(i){return void r(i)}o.done?t(c):Promise.resolve(c).then(n,a)}function R(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function l(e){C(s,n,a,l,o,"next",e)}function o(e){C(s,n,a,l,o,"throw",e)}l(void 0)}))}}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){O(e,t,r[t])}))}return e}function I(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,s=[],l=!0,o=!1;try{for(r=r.call(e);!(l=(n=r.next()).done)&&(s.push(n.value),!t||s.length!==t);l=!0);}catch(c){o=!0,a=c}finally{try{l||null==r.return||r.return()}finally{if(o)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var E="mb-4 mensaje-exito px-4 py-3 relative",_="mb-4 mensaje-error px-4 py-3 relative",U={currentPage:1,itemsPerPage:10,totalItems:10,itemCount:0,totalPages:5},M=!0,B=function(e){var t=e.roles,r=A(l.useState(""),2),n=r[0],i=r[1],m=A(l.useState(""),2),x=m[0],b=m[1],j=A(l.useState(!1),2),g=j[0],y=j[1],S=(0,w.useRouter)(),C=A(l.useState([]),2),O=C[0],M=C[1],B=A(l.useState(!1),2),T=B[0],D=B[1],z=A(l.useReducer((function(e,t){return k({},e,t)}),{IdSearched:"",statusRol:"",dataUser:[],messageRol:""}),2),L=z[0],V=L.IdSearched,F=L.statusRol,H=L.dataUser,K=L.messageRol,Z=z[1],X=A(l.useState(U),2),$=X[0],Q=X[1],q=$.currentPage,G=$.itemsPerPage;l.useEffect((function(){function e(){return(e=R(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.prev=1,e.next=4,(0,c.rK)("roles/administrador?page=".concat($.currentPage,"&limit=").concat($.itemsPerPage),{type:c.lO.auth});case 4:return t=e.sent,e.next=7,t.json();case 7:r=e.sent,200===t.status?(Q(null===r||void 0===r?void 0:r.meta),Z({dataUser:(null===r||void 0===r?void 0:r.items)||[]}),M((null===r||void 0===r?void 0:r.items)||[]),y(!1)):Q(U),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),Q(U);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[q,G,$.currentPage,$.itemsPerPage]);var J=function(){var e=R(a().mark((function e(){var t,r,n,s,l,o,c,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z({statusRol:null===x||void 0===x?void 0:x.valor}),t=H.filter((function(e){return Number(null===e||void 0===e?void 0:e.cedula)===Number(null===x||void 0===x?void 0:x.cedula)})),r=t[0],n=r.telefono,s=r.celular,l=r.cedula,o=I(r,["telefono","celular","cedula"]),c=k({},o,{cedula:Number(l),telefono:Number(n),celular:Number(s),rolID:Number(null===x||void 0===x?void 0:x.valor)}),e.prev=4,u="".concat("https://www.medellin.gov.co/bancopobres/autenticacionms/","roles/actualizar-usuario-rol"),e.next=8,(0,p.r)(u,c);case 8:e.sent.responseComplete?(D(!1),i("Proceso exitoso, el Usuario ha sido actualizado."),setTimeout((function(){i(""),S.replace(S.asPath)}),5e3),y(!0),y(!1)):(D(!1),i("Hubo un error, intentalo m\xe1s tarde o comunicate con server."),setTimeout((function(){i("")}),5e3)),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),D(!1),i("Hubo un error, intentalo m\xe1s tarde o comunicate con server."),setTimeout((function(){i("")}),5e3);case 17:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(){return e.apply(this,arguments)}}();return(0,s.jsx)(o.Z,{children:(0,s.jsxs)(v.c,{children:[(0,s.jsx)(P.Z,{children:"Configuraci\xf3n de usuarios"}),(0,s.jsxs)("div",{className:"flex w-full justify-between flex-col-reverse md:flex-row",children:[(0,s.jsx)("div",{className:"flex flex-row items-center justify-center"}),(0,s.jsx)(u,{IdSearched:V,statusRol:F,dispatch:Z,dataUser:H,setLoading:y,dataAdminAsesores:O})]}),""!==K?(0,s.jsx)("div",{className:K.includes("error")?_:E,children:K}):null,V?g?(0,s.jsxs)("div",{className:"flex flex-nowrap flex-row items-center",children:[(0,s.jsx)("div",{className:"h-16 flex items-center",children:"Cargando ..."}),(0,s.jsx)("div",{className:"spinner_cont items-center",children:(0,s.jsx)("span",{className:"material spinner"})})]}):H.length>0?(0,s.jsx)(d,{children:H.map((function(e,r){return(0,s.jsx)(h,{cedula:e.cedula,nombres:e.nombres,apellidos:e.apellidos,correo:e.correo,rol:{rolUser:e.rol,dataRoles:t,dispatch:Z,statusRol:F,setBoxConfirmChange:D,setRolValueSelected:b},acciones:"ACCIONES"},r)}))}):"No se encontraron resultados":g?(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-nowrap flex-row items-center",children:[(0,s.jsx)("div",{className:"h-16 flex items-center",children:"Cargando ..."}),(0,s.jsx)("div",{className:"spinner_cont items-center",children:(0,s.jsx)("span",{className:"material spinner"})})]})," "]}):O.length>0?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"card-custom",children:[(0,s.jsx)("div",{className:"header-card-custom",children:(0,s.jsx)("span",{children:"Lista de Usuarios"})}),(0,s.jsxs)("div",{className:"body-card-custom",children:[(0,s.jsx)(d,{children:O.map((function(e,r){return(0,s.jsx)(h,{cedula:e.cedula,nombres:e.nombres,apellidos:e.apellidos,correo:e.correo,rol:{rolUser:e.rol,dataRoles:t,dispatch:Z,statusRol:e.rolID,setBoxConfirmChange:D,setRolValueSelected:b},acciones:"ACCIONES"},r)}))}),(0,s.jsx)(N,{meta:$,setMeta:Q})]})]})}):"No se han encontrado resultados",(0,s.jsx)("div",{id:"confirm-changes",className:T&&"fixed inset-0 bg-modal-info  flex justify-center z-50"}),T?(0,s.jsx)(f.Z,{nodo:"confirm-changes",children:(0,s.jsxs)("div",{className:"border card-modal-sm flex flex-col",children:[(0,s.jsxs)("div",{className:"body-card-modal-sm",children:[(0,s.jsx)("h1",{className:"titulo-modal-info",children:"Confirmar acci\xf3n"}),(0,s.jsx)("p",{children:"\xbfEst\xe1s seguro deseas cambiar el rol de este usuario?"})]}),(0,s.jsxs)("div",{className:"flex justify-center footer-card-modal-sm",children:[(0,s.jsx)("button",{type:"submit",className:"btn-primario order-2 ml-4",onClick:J,children:"Si"}),(0,s.jsx)("button",{type:"submit",className:" order-1 btn-texto-gris",onClick:function(){D(!1)},children:"Cancelar"})]})]})}):null,""!==n?(0,s.jsx)("div",{className:n.includes("error")?_:E,children:n}):null]})})}}},function(e){e.O(0,[774,888,179],(function(){return t=3340,e(e.s=t);var t}));var t=e.O();_N_E=t}]);