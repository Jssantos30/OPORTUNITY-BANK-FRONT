(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[31],{765:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backoffice/roles-admin",function(){return t(4311)}])},4311:function(e,r,t){"use strict";t.r(r),t.d(r,{__N_SSP:function(){return O},default:function(){return I}});var n=t(4051),o=t.n(n),s=t(5893),a=t(7294),l=t(4986);function c(e,r,t,n,o,s,a){try{var l=e[s](a),c=l.value}catch(i){return void t(i)}l.done?r(c):Promise.resolve(c).then(n,o)}var i=function(e){var r=e.IdSearched,t=e.dispatch,n=e.setLoading,a=function(){var e,s=(e=o().mark((function e(){var s,a,c,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=16;break}return n(!0),e.prev=2,e.next=5,(0,l.rK)("roles/listar-usuario-rol/".concat(r),{type:l.lO.auth});case 5:return s=e.sent,e.next=8,s.json();case 8:a=e.sent,400===s.status&&(t({messageRol:"Hubo un error, no ha iniciado sesi\xf3n en el portal por primera vez :( "}),setTimeout((function(){t({messageRol:""})}),5e3),n(!1)),200===s.status&&(i=[a].filter((function(e){var r=e.rolID;return 1===r||4===r})),t({dataUser:i||[],messageRol:"",statusRol:(null===(c=i[0])||void 0===c?void 0:c.rolID)||""}),n(!1)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),n(!1);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var s=e.apply(r,t);function a(e){c(s,n,o,a,l,"next",e)}function l(e){c(s,n,o,a,l,"throw",e)}a(void 0)}))});return function(){return s.apply(this,arguments)}}();return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"card-custom mb-4",children:[(0,s.jsx)("div",{className:"header-card-custom",children:(0,s.jsx)("span",{children:"Buscar"})}),(0,s.jsx)("div",{className:"body-card-custom",children:(0,s.jsx)("div",{className:"w-full my-1 items-center flex flex-col md:flex-row",children:(0,s.jsxs)("div",{className:"w-full mb-2",children:[(0,s.jsx)("label",{For:"userId",children:"Buscar por c\xe9dula"}),(0,s.jsxs)("div",{className:"flex relative items-center",children:[(0,s.jsx)("input",{type:"text",className:"w-full border rounded-full px-4 py-2 text-center",placeholder:"Buscar por c\xe9dula",name:"userId",value:r,onKeyDown:function(e){return function(e){13===e.keyCode&&a(e)}(e)},onChange:function(e){return t({IdSearched:e.target.value})}}),(0,s.jsx)("img",{src:"".concat("/bancopobres","/Search-Icon.svg"),alt:"search",className:"absolute right-4"})]})]})})}),(0,s.jsx)("div",{className:"footer-card-custom",children:(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex flex-row justify-end mb-8 md:mb-0",children:[(0,s.jsx)("button",{type:"submit",onClick:function(){t({IdSearched:""}),n(!0),setTimeout((function(){n(!1)}),2e3)},className:"btn-texto ml-2",children:"Limpiar"}),(0,s.jsx)("button",{className:"btn-primario ml-2",type:"submit",onClick:a,children:"Buscar"})]})})})]})})};var u=function(e){var r=e.children;return(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"w-full mx-auto bg-white rounded-lg",children:[(0,s.jsx)("thead",{className:"border-b font-bold",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"p-4 text-center",children:"C.C"}),(0,s.jsx)("th",{className:"p-4 text-center",children:"Nombres"}),(0,s.jsx)("th",{className:"p-4 text-center",children:"Apellidos"}),(0,s.jsx)("th",{className:"p-4 text-center",children:"Email"}),(0,s.jsx)("th",{className:"p-4 text-center",children:"Rol"})]})}),r]})})};function d(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var f=function(e){return(0,s.jsx)("tbody",{children:(0,s.jsxs)("tr",{className:"border-b last:border-b-0 font-section",children:[(0,s.jsx)("td",{className:"text-center p-4",children:e.cedula}),(0,s.jsx)("td",{className:"text-center p-4",children:e.nombres}),(0,s.jsx)("td",{className:"text-center p-4",children:e.apellidos}),(0,s.jsx)("td",{className:"text-center p-4",children:e.correo}),(0,s.jsxs)("td",{className:"text-center p-4",children:[" ",(0,s.jsx)(m,{dataRoles:e.rol.dataRoles,currentRolUser:e.rol.rolUser,dipatch:e.rol.dipatch,statusRol:e.rol.statusRol,setBoxConfirmChange:e.rol.setBoxConfirmChange,setRolValueSelected:e.rol.setRolValueSelected,cedula:e.cedula})]})]})})};function m(e){var r=e.dataRoles,t=e.statusRol,n=e.setBoxConfirmChange,o=e.setRolValueSelected,a=e.cedula;return(0,s.jsx)("select",{name:a,value:t,onChange:function(e){var r;n(!0),o((d(r={},e.target.name,e.target.value),d(r,"cedula",e.target.name),d(r,"valor",e.target.value),r))},children:r.map((function(e){return(0,s.jsxs)("option",{value:e.id,children:[" ",e.nombre," "]},e.id)}))})}var h=t(1163),x=t(6795),p=function(e){var r=e.children,t=e.preventRedirect,n=(0,h.useRouter)(),o=n.push,l=n.route,c=(0,x.Eu)(),i=c.isAuth,u=c.status,d=c.rol;return a.useEffect((function(){i||t||u!==x.Q_.resolved||o("/login")}),[i,t,o,u]),a.useEffect((function(){l.includes("backoffice/roles-admin")&&!["ADMINISTRADOR"].includes(d)&&o("/backoffice")}),[d,l,i]),(0,s.jsx)(s.Fragment,{children:r})},v=t(7420),b=(t(8198),t(5681)),j=t(843),g=t(1319);function N(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function y(e,r,t,n,o,s,a){try{var l=e[s](a),c=l.value}catch(i){return void t(i)}l.done?r(c):Promise.resolve(c).then(n,o)}function w(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function S(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){w(e,r,t[r])}))}return e}function R(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function C(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,s=[],a=!0,l=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(s.push(n.value),!r||s.length!==r);a=!0);}catch(c){l=!0,o=c}finally{try{a||null==t.return||t.return()}finally{if(l)throw o}}return s}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return N(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return N(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var O=!0,I=function(e){var r=e.asesores,t=e.roles,n=C(a.useState([]),2),l=n[0],c=n[1],d=C(a.useState(!1),2),m=d[0],h=d[1],x=C(a.useReducer((function(e,r){return S({},e,r)}),{IdSearched:"",statusRol:"",dataUser:[]}),2),N=x[0],w=N.IdSearched,O=N.statusRol,I=N.dataUser,_=x[1],k=C(a.useState(""),2),A=k[0],E=k[1],P=C(a.useState(""),2),U=P[0],D=P[1],B=C(a.useState(!1),2),T=B[0],V=B[1];a.useEffect((function(){h(!0),_({dataUser:r||[]}),c(r||[]),h(!1)}),[w,r]);var z=function(){var e,r=(e=o().mark((function e(){var r,t,n,s,a,l,c,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _({statusRol:null===U||void 0===U?void 0:U.valor}),r=I.filter((function(e){return Number(null===e||void 0===e?void 0:e.cedula)===Number(null===U||void 0===U?void 0:U.cedula)})),t=r[0],n=t.telefono,s=t.celular,a=t.cedula,l=R(t,["telefono","celular","cedula"]),c=S({},l,{cedula:Number(a),telefono:Number(n),celular:Number(s),rolID:Number(null===U||void 0===U?void 0:U.valor)}),e.prev=4,i="".concat("https://www.medellin.gov.co/bancopobres/autenticacionms/","roles/actualizar-usuario-rol"),e.next=8,(0,j.r)(i,c);case 8:e.sent.responseComplete?(V(!1),E("Proceso exitoso, el Usuario ha sido actualizado."),setTimeout((function(){E("")}),5e3),h(!0),h(!1)):(V(!1),E("Hubo un error, intentalo m\xe1s tarde o comunicate con server."),setTimeout((function(){E("")}),5e3)),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(4),V(!1),E("Hubo un error, intentalo m\xe1s tarde o comunicate con server."),setTimeout((function(){E("")}),5e3);case 17:case"end":return e.stop()}}),e,null,[[4,12]])})),function(){var r=this,t=arguments;return new Promise((function(n,o){var s=e.apply(r,t);function a(e){y(s,n,o,a,l,"next",e)}function l(e){y(s,n,o,a,l,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();return(0,s.jsx)(b.Z,{children:(0,s.jsxs)(p,{children:[(0,s.jsx)(g.Z,{children:" Configuraci\xf3n de usuarios. "}),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsx)(i,{IdSearched:w,statusRol:O,dispatch:_,dataUser:I,setLoading:h,dataAdminAsesores:l})}),w?m?(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-nowrap flex-row items-center",children:[(0,s.jsx)("div",{className:"h-16 flex items-center",children:"Cargando ..."}),(0,s.jsx)("div",{className:"spinner_cont items-center",children:(0,s.jsx)("span",{className:"material spinner"})})]})," "]}):I.length>0?(0,s.jsx)(u,{children:I.map((function(e,r){return(0,s.jsx)(f,{cedula:e.cedula,nombres:e.nombres,apellidos:e.apellidos,correo:e.correo,rol:{rolUser:e.rol,dataRoles:t,dispatch:_,statusRol:O,setBoxConfirmChange:V,setRolValueSelected:D},acciones:"ACCIONES"},r)}))}):"No se encontraron resultados":m?(0,s.jsx)("div",{children:"Loading .... "}):r.length>0?(0,s.jsx)(u,{children:r.map((function(e,r){return(0,s.jsx)(f,{cedula:e.cedula,nombres:e.nombres,apellidos:e.apellidos,correo:e.correo,rol:{rolUser:e.rol||void 0,dataRoles:t,dispatch:_,statusRol:e.rolID,setBoxConfirmChange:V,setRolValueSelected:D},acciones:"ACCIONES"},r)}))}):"No se han encontrado resultados",(0,s.jsx)("div",{id:"confirm-changes-ADMIN",className:T&&"fixed inset-5 bg-modal-info  flex items-center justify-center z-50"}),T?(0,s.jsx)(v.Z,{nodo:"confirm-changes-ADMIN",children:(0,s.jsxs)("div",{className:"border rounded-lg p-4 flex flex-col bg-white ",children:[(0,s.jsx)("h1",{children:"Est\xe1s seguro deseas cambiar el rol de este usuario "}),(0,s.jsxs)("div",{className:"flex justify-center",children:[(0,s.jsx)("button",{type:"submit",className:"mr-4 mt-6 p-2 w-2/5 font-bold text-white rounded-full bg-color_primary_2_ligth",onClick:z,children:"Si"}),(0,s.jsx)("button",{type:"submit",className:"mt-6 p-2 w-2/5 font-bold text-white rounded-full bg-red-500",onClick:function(){V(!1)},children:"No"})]})]})}):null,""!==A?(0,s.jsx)("div",{className:A.includes("error")?"mb-4 bg-modal-delete border border-red-400 text-red-700 px-4 py-3 rounded relative":"mb-4 bg-modal-success border border-green-400 text-green-700 px-4 py-3 rounded relative",children:A}):null]})})}}},function(e){e.O(0,[774,888,179],(function(){return r=765,e(e.s=r);var r}));var r=e.O();_N_E=r}]);